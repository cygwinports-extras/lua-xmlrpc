diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/luaxmlrpc-1.0b/cgi.lua src/luaxmlrpc-1.0b/cgi.lua
--- origsrc/luaxmlrpc-1.0b/cgi.lua	2004-12-02 12:32:08.000000000 -0600
+++ src/luaxmlrpc-1.0b/cgi.lua	2008-02-13 15:15:59.906250000 -0600
@@ -2,7 +2,7 @@
 -- $Id: lua-xmlrpc-1.0b-1.src.patch,v 1.1 2008-02-13 21:18:06 yselkowitz Exp $
 
 require"xmlrpc"
-require"post"
+require"cgilua.post"
 post.setmaxinput (1024 * 1024)
 post.setmaxfilesize (512 * 1024)
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/luaxmlrpc-1.0b/http.lua src/luaxmlrpc-1.0b/http.lua
--- origsrc/luaxmlrpc-1.0b/http.lua	2004-12-02 12:32:08.000000000 -0600
+++ src/luaxmlrpc-1.0b/http.lua	2008-02-13 15:11:45.921875000 -0600
@@ -4,11 +4,10 @@
 -- $Id: lua-xmlrpc-1.0b-1.src.patch,v 1.1 2008-02-13 21:18:06 yselkowitz Exp $
 ---------------------------------------------------------------------
 
-require"socket"
+require"socket.http"
+require"ltn12"
 require"xmlrpc"
 
-local post = socket.http.post
-
 xmlrpc.http = {}
 
 ---------------------------------------------------------------------
@@ -19,17 +18,22 @@
 --	XML-RPC element).
 ---------------------------------------------------------------------
 function xmlrpc.http.call (url, method, ...)
-	local body, headers, code, err = post {
+	local body = {}
+	local data = xmlrpc.clEncode (method, unpack (arg))
+	local rc, code, headers = socket.http.request {
+		method = "POST",
+		source = ltn12.source.string(data),
 		url = url,
-		body = xmlrpc.clEncode (method, unpack (arg)),
 		headers = {
 			["User-agent"] = "LuaXMLRPC",
 			["Content-type"] = "text/xml",
+			["Content-length"] = tostring(string.len(data)),
 		},
 	}
-	if tonumber (code) == 200 then
+	body = table.concat(body)
+	if rc == 1 and tonumber (code) == 200 then
 		return xmlrpc.clDecode (body)
 	else
-		error (err or code)
+		error (code)
 	end
 end
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/luaxmlrpc-1.0b/xmlrpc.lua src/luaxmlrpc-1.0b/xmlrpc.lua
--- origsrc/luaxmlrpc-1.0b/xmlrpc.lua	2004-12-02 12:32:08.000000000 -0600
+++ src/luaxmlrpc-1.0b/xmlrpc.lua	2008-02-13 15:06:31.328125000 -0600
@@ -13,7 +13,7 @@
 local ceil = math.ceil
 local parse = lxp.lom.parse
 
-module (arg and arg[1])
+module("xmlrpc")
 
 _COPYRIGHT = "Copyright (C) 2003-2004 Kepler Project"
 _DESCRIPTION = "LuaXMLRPC is a library to make remote procedure calls using XML-RPC"
